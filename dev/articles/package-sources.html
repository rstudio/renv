<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Package sources • renv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Package sources">
<meta name="robots" content="noindex">
<!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager -->
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">renv</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/renv.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/package-sources.html">Package sources</a></li>
    <li><a class="dropdown-item" href="../articles/package-install.html">Installing packages</a></li>
    <li><a class="dropdown-item" href="../articles/python.html">Using Python with renv</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/packrat.html">packrat vs. renv</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Deployment</h6></li>
    <li><a class="dropdown-item" href="../articles/ci.html">Using renv with continuous integration</a></li>
    <li><a class="dropdown-item" href="../articles/docker.html">Using renv with Docker</a></li>
    <li><a class="dropdown-item" href="../articles/rsconnect.html">Using renv with Posit Connect</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Package development</a></li>
    <li><a class="dropdown-item" href="../articles/profiles.html">Project profiles</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/renv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Package sources</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/renv/blob/main/vignettes/package-sources.Rmd" class="external-link"><code>vignettes/package-sources.Rmd</code></a></small>
      <div class="d-none name"><code>package-sources.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/renv/">renv</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'renv'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     embed, update</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     history, upgrade</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     autoload, load, remove, use</span></span></code></pre></div>
<div class="section level2">
<h2 id="package-sources">Package sources<a class="anchor" aria-label="anchor" href="#package-sources"></a>
</h2>
<p>renv uses an installed package’s <code>DESCRIPTION</code> file to
infer its source. For example, packages installed from the CRAN
repositories typically have the field:</p>
<pre><code><span><span class="va">Repository</span><span class="op">:</span> <span class="va">CRAN</span></span></code></pre>
<p>set, and renv takes this as a signal that the package was retrieved
from CRAN.</p>
<div class="section level3">
<h3 id="inferring-package-sources">Inferring package sources<a class="anchor" aria-label="anchor" href="#inferring-package-sources"></a>
</h3>
<p>The following fields are checked, in order, when inferring a
package’s source:</p>
<ol style="list-style-type: decimal">
<li><p>The <code>RemoteType</code> field; typically written for packages
installed by the devtools, remotes and pak packages,</p></li>
<li><p>The <code>Repository</code> field; for example, packages
retrieved from CRAN will typically have the
<code>Repository: CRAN</code> field,</p></li>
<li><p>The <code>biocViews</code> field; typically present for packages
installed from the Bioconductor repositories,</p></li>
</ol>
<p>As a fallback, if renv is unable to determine a package’s source from
the <code>DESCRIPTION</code> file directly, but a package of the same
name is available in the active R repositories (as specified in
<code>getOption("repos")</code>), then the package will be treated as
though it was installed from an R package repository.</p>
<p>If all of the above methods fail, renv will finally check for a
package available from the <em>cellar</em>. The package cellar is
typically used as an escape hatch, for packages which do not have a
well-defined remote source, or for packages which might not be remotely
accessible from your machine.</p>
</div>
<div class="section level3">
<h3 id="unknown-sources">Unknown sources<a class="anchor" aria-label="anchor" href="#unknown-sources"></a>
</h3>
<p>If renv is unable to infer a package’s source, it will inform you
during <code><a href="../reference/snapshot.html">renv::snapshot()</a></code> – for example, if we attempted to
snapshot a package called <code>skeleton</code> with no known
source:</p>
<pre><code>&gt; renv::snapshot()
The following package(s) were installed from an unknown source:

        skeleton

renv may be unable to restore these packages in the future.
Consider reinstalling these packages from a known source (e.g. CRAN).

Do you want to proceed? [y/N]:</code></pre>
<p>While you can still create a lockfile with such packages,
<code><a href="../reference/restore.html">restore()</a></code> will likely fail unless you can ensure this
package is installed through some other mechanism.</p>
</div>
<div class="section level3">
<h3 id="custom-r-package-repositories">Custom R package repositories<a class="anchor" aria-label="anchor" href="#custom-r-package-repositories"></a>
</h3>
<p>Custom and local R package repositories are supported as well. The
only requirement is that these repositories are set as part of the
<code>repos</code> R option, and that these repositories are named. For
example, you might use:</p>
<pre><code><span><span class="va">repos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span>, WORK <span class="op">=</span> <span class="st">"https://work.example.org"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="va">repos</span><span class="op">)</span></span></code></pre>
<p>to tell renv to work with both the official CRAN package repository,
as well as a package repository you have hosted and set up in your work
environment.</p>
</div>
<div class="section level3">
<h3 id="bioconductor">Bioconductor<a class="anchor" aria-label="anchor" href="#bioconductor"></a>
</h3>
<p>renv has been designed to work together as seamlessly as possible
with the <a href="https://bioconductor.org/" class="external-link">Bioconductor</a> project.
This vignette outlines some of the extra steps that may be required when
using renv with packages obtained from Bioconductor.</p>
</div>
<div class="section level3">
<h3 id="initializing-a-project">Initializing a project<a class="anchor" aria-label="anchor" href="#initializing-a-project"></a>
</h3>
<p>To initialize renv in a project using Bioconductor, you can pass the
<code>bioconductor</code> argument to <code><a href="../reference/init.html">renv::init()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the latest-available Bioconductor release</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>bioconductor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use a specific version of Bioconductor</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>bioconductor <span class="op">=</span> <span class="st">"3.14"</span><span class="op">)</span></span></code></pre></div>
<p>This will tell renv to activate the appropriate Bioconductor
repositories, and to use those repositories when attempting to restore
packages.</p>
<div class="section level4">
<h4 id="bioconductor-releases">Bioconductor releases<a class="anchor" aria-label="anchor" href="#bioconductor-releases"></a>
</h4>
<p>Bioconductor prepares different versions of its package repositories,
for use with different versions of R. The version of Bioconductor used
within a particular renv project is stored both as a project setting,
and also within the project lockfile. This allows you to “lock” a
particular project to a particular Bioconductor release, even as new
Bioconductor releases are made available for newer versions of R.</p>
<p>To set the version of Bioconductor used in a project, you can
use:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="va"><a href="../reference/settings.html">settings</a></span><span class="op">$</span><span class="fu">bioconductor.version</span><span class="op">(</span><span class="st">"3.14"</span><span class="op">)</span></span></code></pre></div>
<p>If you later choose to upgrade R, you may need to upgrade the version
of Bioconductor used as well.</p>
<p>If you want to override the Bioconductor repositories used by renv,
you can also explicitly set the following option:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>renv.bioconductor.repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="the-package-cellar">The package cellar<a class="anchor" aria-label="anchor" href="#the-package-cellar"></a>
</h3>
<p>In some cases, your project may depend on R packages which are not
available from any external source, or that external source may not be
accessible from the machine calling <code><a href="../reference/restore.html">renv::restore()</a></code>. To
help accommodate these scenarios, renv allows you to prepare a package
“cellar”, to be used as an ad-hoc repository of packages during restore.
This allows you to provide package tarballs that can be used to restore
packages which cannot be retrieved from any other source.</p>
<p>The environment variable <code>RENV_PATHS_CELLAR</code> can be used
to customize the package cellar location. It should point to a directory
containing package binaries and sources, with a structure of the
form:</p>
<ul>
<li>
<code>${RENV_PATHS_CELLAR}/&lt;package&gt;_&lt;version&gt;.tar.gz</code>;
or</li>
<li><code>${RENV_PATHS_CELLAR}/&lt;package&gt;/&lt;package&gt;_&lt;version&gt;.tar.gz</code></li>
</ul>
<p>Alternatively, you can also use a project-local cellar by placing
your packages within a folder located at
<code>&lt;project&gt;/renv/cellar</code>. Note that this folder does not
exist by default; you must create it to opt-in.</p>
<ul>
<li>
<code>&lt;project&gt;/renv/cellar/&lt;package&gt;_&lt;version&gt;.tar.gz</code>;
or</li>
<li><code>&lt;project&gt;/renv/cellar/&lt;package&gt;/&lt;package&gt;_&lt;version&gt;.tar.gz</code></li>
</ul>
<p>As an example, if your project depended on a package
<code>skeleton 1.0.0</code>, you could place a tarball for this package
in one of the following locations:</p>
<ul>
<li><code>${RENV_PATHS_CELLAR}/skeleton_1.0.0.tar.gz</code></li>
<li><code>${RENV_PATHS_CELLAR}/skeleton/skeleton_1.0.0.tar.gz</code></li>
<li>
<code>&lt;project&gt;/renv/cellar/skeleton_1.0.0.tar.gz</code>;
or</li>
<li><code>&lt;project&gt;/renv/cellar/skeleton/skeleton_1.0.0.tar.gz</code></li>
</ul>
<p>Once this is done, renv will consult these directories during future
attempts to restore your packages.</p>
<p>You can install a package from the cellar like any other package,
i.e. <code>renv::install("skeleton")</code>.</p>
<p>During restore, if a compatible package is located within the cellar,
that copy of the package will be preferred even if that package might
otherwise be accessible from its associated remote source. For example,
if <code>skeleton 1.0.0</code> was also available on CRAN,
<code><a href="../reference/restore.html">renv::restore()</a></code> would still use the tarball available in
the cellar rather than the version available from CRAN.</p>
<p>If you want to see what paths renv is using for the cellar, you can
use:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">:::</span><span class="fu">renv_paths_cellar</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../reference/paths.html">?paths</a></code> for more details.</p>
<div class="section level4">
<h4 id="explicit-sources">Explicit sources<a class="anchor" aria-label="anchor" href="#explicit-sources"></a>
</h4>
<p>You can also provide explicit source paths in the lockfile if
desired. This is most useful if you are building an renv lockfile “by
hand”, or need to tweak an existing lockfile to point at a separate
package for installation. For example, you could have a package record
in <code>renv.lock</code> of the form:</p>
<pre><code>{
  "Package": "skeleton",
  "Version": "1.0.1",
  "Source": "/mnt/r/pkg/skeleton_1.0.1.tar.gz"
}</code></pre>
<p>Packages should have the following extensions, depending on whether
the archive contains a binary copy of the package or the package
sources:</p>
<table class="table">
<thead><tr class="header">
<th><strong>Platform</strong></th>
<th><strong>Binary</strong></th>
<th><strong>Sources</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Windows</td>
<td><code>.zip</code></td>
<td><code>.tar.gz</code></td>
</tr>
<tr class="even">
<td>macOS</td>
<td><code>.tgz</code></td>
<td><code>.tar.gz</code></td>
</tr>
<tr class="odd">
<td>Linux</td>
<td><code>.tar.gz</code></td>
<td><code>.tar.gz</code></td>
</tr>
</tbody>
</table>
<p>Note that on Linux, both binaries and sources should have the
<code>.tar.gz</code> extension, but R and renv will handle this as
appropriate during installation.</p>
</div>
</div>
<div class="section level3">
<h3 id="abi-compatibility">ABI compatibility<a class="anchor" aria-label="anchor" href="#abi-compatibility"></a>
</h3>
<p>ABI compatibility issues can arise if different packages were built
against different versions of a shared dependency. For example, one
package may have been built against Rcpp 1.0.6, and another package
might have been built against Rcpp 1.0.7. However, because only one
version of the Rcpp package can be loaded at a time within an R session,
mixing of these two packages might cause issues either on load or at
runtime depending on the version of Rcpp available.</p>
<p>It’s worth emphasizing that this is not Rcpp’s fault; a package built
against Rcpp 1.0.7 would reasonably expect newer APIs made available by
that version of the package would be available at runtime, and that
contract would be violated if an older version of Rcpp were installed in
the project library. The challenge for renv is that this build-time
dependency is not clearly communicated to renv; in general, it is not
possible to know what packages (and their versions) a particular package
was built against.</p>
</div>
<div class="section level3">
<h3 id="build-time-dependencies">Build-time dependencies<a class="anchor" aria-label="anchor" href="#build-time-dependencies"></a>
</h3>
<p>R packages might occasionally (and unintentionally) take a build-time
dependency on another R package – for example, a package with the
code:</p>
<pre><code><span><span class="va">`%&gt;%`</span> <span class="op">&lt;-</span> <span class="fu">magrittr</span><span class="fu">::</span><span class="va">`%&gt;%`</span></span></code></pre>
<p>would take the version of <code>%&gt;%</code> that was available from
the version of magrittr that was available at <em>build</em> time, not
the one available at <em>run</em> time. This could be problematic if,
for example, an update to the magrittr package changed in a way that
made old definitions of <code>%&gt;%</code> incompatible with newer
internal functions.</p>
<p>In general, it is a mistake for packages to take a build-time
dependency on exported objects from another package; rather, such
objects should be imported at runtime (using
e.g. <code>importFrom()</code> in the package <code>NAMESPACE</code>
file).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Kevin Ushey, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


  </body>
</html>
