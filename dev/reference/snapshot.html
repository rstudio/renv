<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Record current state of the project library in the lockfile — snapshot • renv</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Record current state of the project library in the lockfile — snapshot"><meta name="description" content="Call renv::snapshot() to update a lockfile with the current state of
dependencies in the project library. The lockfile can be used to later
restore these dependencies as required.
It's also possible to call renv::snapshot() with a non-renv project,
in which case it will record the current state of dependencies in the
current library paths. This makes it possible to restore the current packages,
providing lightweight portability and reproducibility without isolation.
If you want to automatically snapshot after each change, you can
set config$config$auto.snapshot(TRUE) – see ?config for more details."><meta property="og:description" content="Call renv::snapshot() to update a lockfile with the current state of
dependencies in the project library. The lockfile can be used to later
restore these dependencies as required.
It's also possible to call renv::snapshot() with a non-renv project,
in which case it will record the current state of dependencies in the
current library paths. This makes it possible to restore the current packages,
providing lightweight portability and reproducibility without isolation.
If you want to automatically snapshot after each change, you can
set config$config$auto.snapshot(TRUE) – see ?config for more details."><meta property="og:image" content="https://rstudio.github.io/renv/logo.svg"><meta name="robots" content="noindex"><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager --></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">renv</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/renv.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/package-sources.html">Package sources</a></li>
    <li><a class="dropdown-item" href="../articles/package-install.html">Installing packages</a></li>
    <li><a class="dropdown-item" href="../articles/python.html">Using Python with renv</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/packrat.html">packrat vs. renv</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Deployment</h6></li>
    <li><a class="dropdown-item" href="../articles/ci.html">Using renv with continuous integration</a></li>
    <li><a class="dropdown-item" href="../articles/docker.html">Using renv with Docker</a></li>
    <li><a class="dropdown-item" href="../articles/rsconnect.html">Using renv with Posit Connect</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Package development</a></li>
    <li><a class="dropdown-item" href="../articles/profiles.html">Project profiles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/renv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Record current state of the project library in the lockfile</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/renv/blob/main/R/snapshot.R" class="external-link"><code>R/snapshot.R</code></a></small>
      <div class="d-none name"><code>snapshot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Call <code>renv::snapshot()</code> to update a <a href="lockfile-api.html">lockfile</a> with the current state of
dependencies in the project library. The lockfile can be used to later
<a href="restore.html">restore</a> these dependencies as required.</p>
<p>It's also possible to call <code>renv::snapshot()</code> with a non-renv project,
in which case it will record the current state of dependencies in the
current library paths. This makes it possible to <a href="restore.html">restore</a> the current packages,
providing lightweight portability and reproducibility without isolation.</p>
<p>If you want to automatically snapshot after each change, you can
set <code>config$config$auto.snapshot(TRUE)</code> – see <code><a href="config.html">?config</a></code> for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">snapshot</span><span class="op">(</span></span>
<span>  project <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  library <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lockfile <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="fu">lockfile</span><span class="op">(</span>project <span class="op">=</span> <span class="va">project</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="va">settings</span><span class="op">$</span><span class="fu">snapshot.type</span><span class="op">(</span>project <span class="op">=</span> <span class="va">project</span><span class="op">)</span>,</span>
<span>  dev <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>,</span>
<span>  packages <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prompt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  update <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reprex <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>The project directory. If <code>NULL</code>, then the active project will
be used. If no project is currently active, then the current working
directory is used instead.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Unused arguments, reserved for future expansion. If any arguments
are matched to <code>...</code>, renv will signal an error.</p></dd>


<dt id="arg-library">library<a class="anchor" aria-label="anchor" href="#arg-library"></a></dt>
<dd><p>The <span style="R">R</span> libraries to snapshot. When <code>NULL</code>, the active <span style="R">R</span>
libraries (as reported by <code><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths()</a></code>) are used.</p></dd>


<dt id="arg-lockfile">lockfile<a class="anchor" aria-label="anchor" href="#arg-lockfile"></a></dt>
<dd><p>The location where the generated lockfile should be written.
By default, the lockfile is written to a file called <code>renv.lock</code> in the
project directory. When <code>NULL</code>, the lockfile (as an <span style="R">R</span> object) is returned
directly instead.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of snapshot to perform:</p><ul><li><p><code>"implicit"</code>, (the default), uses all packages captured by <code><a href="dependencies.html">dependencies()</a></code>.</p></li>
<li><p><code>"explicit"</code> uses packages recorded in <code>DESCRIPTION</code>.</p></li>
<li><p><code>"all"</code> uses all packages in the project library.</p></li>
<li><p><code>"custom"</code> uses a custom filter.</p></li>
</ul><p>See <strong>Snapshot types</strong> below for more details.</p></dd>


<dt id="arg-dev">dev<a class="anchor" aria-label="anchor" href="#arg-dev"></a></dt>
<dd><p>Boolean; include development dependencies? These packages are
typically required when developing the project, but not when running it
(i.e. you want them installed when humans are working on the project but
not when computers are deploying it).</p>
<p>Development dependencies include packages listed in the <code>Suggests</code> field
of a <code>DESCRIPTION</code> found in the project root, and roxygen2 or devtools if
their use is implied by other project metadata. They also include packages
used in <code>~/.Rprofile</code> if <code>config$user.profile()</code> is <code>TRUE</code>.</p></dd>


<dt id="arg-repos">repos<a class="anchor" aria-label="anchor" href="#arg-repos"></a></dt>
<dd><p>The <span style="R">R</span> repositories to be recorded in the lockfile. Defaults
to the currently active package repositories, as retrieved by
<code>getOption("repos")</code>.</p></dd>


<dt id="arg-packages">packages<a class="anchor" aria-label="anchor" href="#arg-packages"></a></dt>
<dd><p>A vector of packages to be included in the lockfile. When
<code>NULL</code> (the default), all packages relevant for the type of snapshot being
performed will be included. When set, the <code>type</code> argument is ignored.
Recursive dependencies of the specified packages will be added to the
lockfile as well.</p></dd>


<dt id="arg-exclude">exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>A vector of packages to be explicitly excluded from the lockfile.
Note that transitive package dependencies will always be included, to avoid
potentially creating an incomplete / non-functional lockfile.</p></dd>


<dt id="arg-prompt">prompt<a class="anchor" aria-label="anchor" href="#arg-prompt"></a></dt>
<dd><p>Boolean; prompt the user before taking any action? For backwards
compatibility, <code>confirm</code> is accepted as an alias for <code>prompt</code>.</p></dd>


<dt id="arg-update">update<a class="anchor" aria-label="anchor" href="#arg-update"></a></dt>
<dd><p>Boolean; if the lockfile already exists, then attempt to update
that lockfile without removing any prior package records.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>Boolean; force generation of a lockfile even when pre-flight
validation checks have failed?</p></dd>


<dt id="arg-reprex">reprex<a class="anchor" aria-label="anchor" href="#arg-reprex"></a></dt>
<dd><p>Boolean; generate output appropriate for embedding the lockfile
as part of a <a href="https://www.tidyverse.org/help/#reprex" class="external-link">reprex</a>?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The generated lockfile, as an <span style="R">R</span> object (invisibly). Note that
this function is normally called for its side effects.</p>
    </div>
    <div class="section level2">
    <h2 id="snapshot-types">Snapshot types<a class="anchor" aria-label="anchor" href="#snapshot-types"></a></h2>
    <p>Depending on how you prefer to manage your <span style="R">R</span> package dependencies, you may
want to enable an alternate snapshot type.. The types available are as follows:</p>
<dl><dt><code>"implicit"</code></dt>
<dd><p>(The default) Capture only packages which appear to be used in your project,
as determined by <code><a href="dependencies.html">renv::dependencies()</a></code>. This ensures that only the packages
actually required by your project will enter the lockfile; the downside
if it might be slow if your project contains a large number of files.
If speed becomes an issue, you might consider using <code>.renvignore</code> files to
limit which files renv uses for dependency discovery, or switching to
explicit mode, as described next.</p></dd>


<dt><code>"explicit"</code></dt>
<dd><p>Only capture packages which are explicitly listed in the project
<code>DESCRIPTION</code> file. This workflow is recommended for users who wish to
manage their project's <span style="R">R</span> package dependencies directly, and can be used
for both package and non-package <span style="R">R</span> projects. Packages used in this manner
should be recorded in either the <code>Depends</code> or <code>Imports</code> field of the
<code>DESCRIPTION</code> file.</p></dd>


<dt><code>"all"</code></dt>
<dd><p>Capture all packages within the active <span style="R">R</span> libraries in the lockfile.
This is the quickest and simplest method, but may lead to undesired
packages (e.g. development dependencies) entering the lockfile.</p></dd>


<dt><code>"custom"</code></dt>
<dd><p>Like <code>"implicit"</code>, but use a custom user-defined filter instead. The filter
should be specified by the <span style="R">R</span> option <code>renv.snapshot.filter</code>, and should
either be a character vector naming a function (e.g. <code>"package::method"</code>),
or be a function itself. The function should only accept one argument (the
project directory), and should return a vector of package names to include
in the lockfile.</p></dd>



</dl><p>You can change the snapshot type for the current project with <code><a href="settings.html">settings()</a></code>.
For example, the following code will switch to using <code>"explicit"</code> snapshots:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>renv<span class="sc">::</span>settings<span class="sc">$</span><span class="fu">snapshot.type</span>(<span class="st">"explicit"</span>)</span></code></pre><p></p></div>
<p>When the <code>packages</code> argument is set, <code>type</code> is ignored, and instead only the
requested set of packages, and their recursive dependencies, will be written
to the lockfile.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>More on handling package <code><a href="dependencies.html">dependencies()</a></code></p>
<p>Other reproducibility:
<code><a href="lockfiles.html">lockfiles</a></code>,
<code><a href="restore.html">restore</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># disable automatic snapshots</span></span></span>
<span class="r-in"><span><span class="va">auto.snapshot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"renv.config.auto.snapshot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>renv.config.auto.snapshot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># initialize a new project (with an empty R library)</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="init.html">init</a></span><span class="op">(</span>bare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># install digest 0.6.19</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="install.html">install</a></span><span class="op">(</span><span class="st">"digest@0.6.19"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># save library state to lockfile</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove digest from library</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="remove.html">remove</a></span><span class="op">(</span><span class="st">"digest"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check library status</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># restore lockfile, thereby reinstalling digest 0.6.19</span></span></span>
<span class="r-in"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="restore.html">restore</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># restore automatic snapshots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>renv.config.auto.snapshot <span class="op">=</span> <span class="va">auto.snapshot</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Kevin Ushey, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


  </body></html>

