<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Capture and re-use dependencies within a .R, .Rmd or .qmd — embed • renv</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Capture and re-use dependencies within a .R, .Rmd or .qmd — embed"><meta name="description" content="Together, embed() and use() provide a lightweight way to specify and
restore package versions within a file. use() is a lightweight lockfile
specification that embed() can automatically generate and insert into a
script or document.
Calling embed() inspects the dependencies of the specified document then
generates and inserts a call to use() that looks something like this:
renv::use(
  &quot;digest@0.6.30&quot;,
  &quot;rlang@0.3.4&quot;
)

Then, when you next run your R script or render your .Rmd or .qmd, use() will:
Create a temporary library path.
Install the requested packages and their recursive dependencies into that
library.
Activate the library, so it's used for the rest of the script.


Manual usage


You can also create calls to use() yourself, either specifying the
packages needed by hand, or by supplying the path to a lockfile,
renv::use(lockfile = &quot;/path/to/renv.lock&quot;).
This can be useful in projects where you'd like to associate different
lockfiles with different documents, as in a blog where you want each
post to capture the dependencies at the time of writing. Once you've
finished writing each, the post, you can use
renv::snapshot(lockfile = &quot;/path/to/renv.lock&quot;)
to &quot;save&quot; the state that was active while authoring that bost, and then use
renv::use(lockfile = &quot;/path/to/renv.lock&quot;) in that document to ensure the
blog post always uses those dependencies onfuture renders.
renv::use() is inspired in part by the groundhog
package, which also allows one to specify a script's R package requirements
within that same R script.

"><meta property="og:description" content="Together, embed() and use() provide a lightweight way to specify and
restore package versions within a file. use() is a lightweight lockfile
specification that embed() can automatically generate and insert into a
script or document.
Calling embed() inspects the dependencies of the specified document then
generates and inserts a call to use() that looks something like this:
renv::use(
  &quot;digest@0.6.30&quot;,
  &quot;rlang@0.3.4&quot;
)

Then, when you next run your R script or render your .Rmd or .qmd, use() will:
Create a temporary library path.
Install the requested packages and their recursive dependencies into that
library.
Activate the library, so it's used for the rest of the script.


Manual usage


You can also create calls to use() yourself, either specifying the
packages needed by hand, or by supplying the path to a lockfile,
renv::use(lockfile = &quot;/path/to/renv.lock&quot;).
This can be useful in projects where you'd like to associate different
lockfiles with different documents, as in a blog where you want each
post to capture the dependencies at the time of writing. Once you've
finished writing each, the post, you can use
renv::snapshot(lockfile = &quot;/path/to/renv.lock&quot;)
to &quot;save&quot; the state that was active while authoring that bost, and then use
renv::use(lockfile = &quot;/path/to/renv.lock&quot;) in that document to ensure the
blog post always uses those dependencies onfuture renders.
renv::use() is inspired in part by the groundhog
package, which also allows one to specify a script's R package requirements
within that same R script.

"><meta property="og:image" content="https://rstudio.github.io/renv/logo.svg"><meta name="robots" content="noindex"><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager --></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">renv</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/renv.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/package-sources.html">Package sources</a></li>
    <li><a class="dropdown-item" href="../articles/package-install.html">Installing packages</a></li>
    <li><a class="dropdown-item" href="../articles/python.html">Using Python with renv</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/packrat.html">packrat vs. renv</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Deployment</h6></li>
    <li><a class="dropdown-item" href="../articles/ci.html">Using renv with continuous integration</a></li>
    <li><a class="dropdown-item" href="../articles/docker.html">Using renv with Docker</a></li>
    <li><a class="dropdown-item" href="../articles/rsconnect.html">Using renv with Posit Connect</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Package development</a></li>
    <li><a class="dropdown-item" href="../articles/profiles.html">Project profiles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/renv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Capture and re-use dependencies within a <code>.R</code>, <code>.Rmd</code> or <code>.qmd</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/renv/blob/main/R/embed.R" class="external-link"><code>R/embed.R</code></a>, <a href="https://github.com/rstudio/renv/blob/main/R/use.R" class="external-link"><code>R/use.R</code></a></small>
      <div class="d-none name"><code>embed.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Together, <code>embed()</code> and <code>use()</code> provide a lightweight way to specify and
restore package versions within a file. <code>use()</code> is a lightweight lockfile
specification that <code>embed()</code> can automatically generate and insert into a
script or document.</p>
<p>Calling <code>embed()</code> inspects the dependencies of the specified document then
generates and inserts a call to <code>use()</code> that looks something like this:</p>
<p></p><div class="sourceCode R"><pre><code><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="../reference/embed.html">use</a></span><span class="op">(</span></span>
<span>  <span class="st">"digest@0.6.30"</span>,</span>
<span>  <span class="st">"rlang@0.3.4"</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>Then, when you next run your R script or render your <code>.Rmd</code> or <code>.qmd</code>, <code>use()</code> will:</p><ol><li><p>Create a temporary library path.</p></li>
<li><p>Install the requested packages and their recursive dependencies into that
library.</p></li>
<li><p>Activate the library, so it's used for the rest of the script.</p></li>
</ol><div class="section">
<h3 id="manual-usage">Manual usage<a class="anchor" aria-label="anchor" href="#manual-usage"></a></h3>


<p>You can also create calls to <code>use()</code> yourself, either specifying the
packages needed by hand, or by supplying the path to a lockfile,
<code>renv::use(lockfile = "/path/to/renv.lock")</code>.</p>
<p>This can be useful in projects where you'd like to associate different
lockfiles with different documents, as in a blog where you want each
post to capture the dependencies at the time of writing. Once you've
finished writing each, the post, you can use
<code>renv::snapshot(lockfile = "/path/to/renv.lock")</code>
to "save" the state that was active while authoring that bost, and then use
<code>renv::use(lockfile = "/path/to/renv.lock")</code> in that document to ensure the
blog post always uses those dependencies onfuture renders.</p>
<p><code>renv::use()</code> is inspired in part by the <a href="https://groundhogr.com/" class="external-link">groundhog</a>
package, which also allows one to specify a script's <span style="R">R</span> package requirements
within that same <span style="R">R</span> script.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">embed</span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, lockfile <span class="op">=</span> <span class="cn">NULL</span>, project <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">use</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  lockfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  library <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  isolate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sandbox <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  attach <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>The path to an <span style="R">R</span> or R Markdown script. The default will use the current
document, if running within RStudio.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>The <span style="R">R</span> packages to be used with this script. Ignored if <code>lockfile</code> is
non-<code>NULL</code>.</p></dd>


<dt id="arg-lockfile">lockfile<a class="anchor" aria-label="anchor" href="#arg-lockfile"></a></dt>
<dd><p>The lockfile to use. When supplied, renv will use the packages as
declared in the lockfile.</p></dd>


<dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>The project directory. If <code>NULL</code>, then the active project will
be used. If no project is currently active, then the current working
directory is used instead.</p></dd>


<dt id="arg-library">library<a class="anchor" aria-label="anchor" href="#arg-library"></a></dt>
<dd><p>The library path into which the requested packages should be installed.
When <code>NULL</code> (the default), a library path within the <span style="R">R</span> temporary
directory will be generated and used. Note that this same library path
will be re-used on future calls to <code>renv::use()</code>, allowing <code>renv::use()</code>
to be used multiple times within a single script.</p></dd>


<dt id="arg-isolate">isolate<a class="anchor" aria-label="anchor" href="#arg-isolate"></a></dt>
<dd><p>Boolean; should the active library paths be included in the set of library
paths activated for this script? Set this to <code>TRUE</code> if you only want the
packages provided to <code>renv::use()</code> to be visible on the library paths.</p></dd>


<dt id="arg-sandbox">sandbox<a class="anchor" aria-label="anchor" href="#arg-sandbox"></a></dt>
<dd><p>Should the system library be sandboxed? See the sandbox documentation in
<a href="config.html">config</a> for more details. You can also provide an explicit sandbox
path if you want to configure where <code>renv::use()</code> generates its sandbox.
By default, the sandbox is generated within the <span style="R">R</span> temporary directory.</p></dd>


<dt id="arg-attach">attach<a class="anchor" aria-label="anchor" href="#arg-attach"></a></dt>
<dd><p>Boolean; should the set of requested packages be automatically attached?
If <code>TRUE</code>, packages will be loaded and attached via a call
to <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> after install. Ignored if <code>lockfile</code> is non-<code>NULL</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Boolean; be verbose while installing packages?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function is normally called for its side effects.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Kevin Ushey, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


  </body></html>

