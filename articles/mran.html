<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="renv">
<title>Using MRAN Binaries • renv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Using MRAN Binaries">
<meta property="og:description" content="renv">
<meta property="og:image" content="https://rstudio.github.io/renv/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">renv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.17.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/renv.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/lockfile.html">Anatomy of a Lockfile</a>
    <a class="dropdown-item" href="../articles/cellar.html">The Package Cellar</a>
    <a class="dropdown-item" href="../articles/bioconductor.html">Using renv with Bioconductor</a>
    <a class="dropdown-item" href="../articles/mran.html">Using MRAN Binaries</a>
    <a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Collaborating</h6>
    <a class="dropdown-item" href="../articles/collaborating.html">Collaborating with renv</a>
    <a class="dropdown-item" href="../articles/use.html">Using Use</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Packages</h6>
    <a class="dropdown-item" href="../articles/packages.html">Package Development with renv</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Deployment</h6>
    <a class="dropdown-item" href="../articles/ci.html">Using renv with Continuous Integration</a>
    <a class="dropdown-item" href="../articles/docker.html">Using renv with Docker</a>
    <a class="dropdown-item" href="../articles/rsconnect.html">Using renv with RStudio Connect</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Integration</h6>
    <a class="dropdown-item" href="../articles/python.html">Using Python with renv</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced</h6>
    <a class="dropdown-item" href="../articles/profiles.html">Project Profiles</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rstudio/renv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Using MRAN Binaries</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/renv/blob/HEAD/vignettes/mran.Rmd" class="external-link"><code>vignettes/mran.Rmd</code></a></small>
      <div class="d-none name"><code>mran.Rmd</code></div>
    </div>

    
    
<p>When working on macOS and Windows, users will often download and
install package binaries, rather than sources, as provided by CRAN.
However, CRAN only provides binaries for the latest-available version of
a package, and so binaries for older versions of a package will become
inaccessible as that package is updated.</p>
<p><a href="https://mran.microsoft.com/" class="external-link">MRAN</a> is a service provided
by Microsoft that mirrors CRAN every day, and allows users to use
particular snapshots of CRAN as their active repositories within their R
session.</p>
<p>Starting with <code>renv 0.10.0</code>, <code>renv</code> can also
make use of MRAN binary packages when restoring packages on Windows and
macOS. When invoking <code><a href="../reference/install.html">renv::install()</a></code> or
<code><a href="../reference/restore.html">renv::restore()</a></code>, <code>renv</code> will attempt to install
the package from the latest-available MRAN snapshot that still had this
package available.</p>
<p>As an example, the <code>stringi</code> package was updated from
version <code>1.4.5</code> to version <code>1.4.6</code> on 2020-02-17,
and binaries for that version of <code>stringi</code> were made
available for macOS on 2020-02-20. Because of this, the last date on
which <code>stringi 1.4.5</code> macOS binaries were available on CRAN
was <code>2020-02-19</code>.</p>
<p>Fortunately, because MRAN snapshotted CRAN on this date, we can
retrieve that binary. For example, on macOS with R 3.6:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"stringi@1.4.5"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Retrieving <span class="st">'https://mran.microsoft.com/snapshot/2020-02-19/bin/macosx/el-capitan/contrib/3.6/stringi_1.4.5.tgz'</span> ...</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    OK [file is up to date]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>Installing stringi [<span class="dv">1</span>.<span class="fl">4.5</span>] ...</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    OK [installed binary]</span></code></pre></div>
<p>When binaries are available from MRAN, <code>renv</code> should
transparently download and use them when possible. When binaries are not
available, <code>renv</code> will fall back to the old behavior, and
attempt to install packages from sources.</p>
<p>If you prefer not to make use of MRAN (e.g. because you are using
<code>renv</code> in an environment without external internet access),
you can disable it with:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>renv.config.mran.enabled <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<p>See also the <code><a href="../reference/equip.html">?renv::equip</a></code> function, which can assist you
in preparing your environment for compilation of packages.</p>
<div class="section level2">
<h2 id="caveats">Caveats<a class="anchor" aria-label="anchor" href="#caveats"></a>
</h2>
<p>While being able to install binary packages from arbitrary MRAN
snapshots can be useful, one must be aware of potential incompatibility
issues. In particular, we need to consider:</p>
<ul>
<li>ABI compatibility between different versions of binaries;</li>
<li>Inadvertent build-time dependencies taken by a package.</li>
</ul>
<div class="section level3">
<h3 id="abi-compatibility">ABI Compatibility<a class="anchor" aria-label="anchor" href="#abi-compatibility"></a>
</h3>
<p>ABI compatibility issues can arise if different packages were built
against different versions of a shared dependency. For example, one
package may have been built against Rcpp 1.0.6, and another package
might have been built against Rcpp 1.0.7. However, because only one
version of the Rcpp package can be loaded at a time within an R session,
mixing of these two packages might cause issues either on load or at
runtime depending on the version of Rcpp available.</p>
<p>It’s worth emphasizing that this is not Rcpp’s fault; a package built
against Rcpp 1.0.7 would reasonably expect newer APIs made available by
that version of the package would be available at runtime, and that
contract would be violated if an older version of Rcpp were installed in
the project library. The challenge for <code>renv</code> is that this
build-time dependency is not clearly communicated to <code>renv</code>;
in general, it is not possible to know what packages (and their
versions) a particular package was built against.</p>
</div>
<div class="section level3">
<h3 id="build-time-dependencies">Build-time Dependencies<a class="anchor" aria-label="anchor" href="#build-time-dependencies"></a>
</h3>
<p>R packages might occasionally (and unintentionally) take a build-time
dependency on another R package – for example, a package with the
code:</p>
<pre><code><span><span class="va">`%&gt;%`</span> <span class="op">&lt;-</span> <span class="fu">magrittr</span><span class="fu">::</span><span class="va">`%&gt;%`</span></span></code></pre>
<p>would take the version of <code>%&gt;%</code> that was available from
the version of magrittr that was available at <em>build</em> time, not
the one available at <em>run</em> time. This could be problematic if,
for example, an update to the <code>magrittr</code> package changed in a
way that made old definitions of <code>%&gt;%</code> incompatible with
newer internal functions.</p>
<p>In general, it is a mistake for packages to take a build-time
dependency on exported objects from another package; rather, such
objects should be imported at runtime (using
e.g. <code>importFrom()</code> in the package <code>NAMESPACE</code>
file).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Ushey, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.9000.</p>
</div>

    </footer>
</div>

  

  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


  </body>
</html>
